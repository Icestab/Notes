<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>红米2100路由器刷机 | 个人杂记</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/image/f.ico">
    <meta name="description" content="Accept what was and what is, and you&#39;ll more positive energy to pursue what will be.">
    
    <link rel="preload" href="/assets/css/0.styles.b4c82722.css" as="style"><link rel="preload" href="/assets/js/app.549933da.js" as="script"><link rel="preload" href="/assets/js/2.8ec7856a.js" as="script"><link rel="preload" href="/assets/js/10.743f19ee.js" as="script"><link rel="prefetch" href="/assets/js/11.f35d8534.js"><link rel="prefetch" href="/assets/js/12.82065eb2.js"><link rel="prefetch" href="/assets/js/13.259b6ebd.js"><link rel="prefetch" href="/assets/js/14.1810b396.js"><link rel="prefetch" href="/assets/js/15.0a90799e.js"><link rel="prefetch" href="/assets/js/16.16775973.js"><link rel="prefetch" href="/assets/js/17.8fc77386.js"><link rel="prefetch" href="/assets/js/18.6bc6fd78.js"><link rel="prefetch" href="/assets/js/19.ab6849ba.js"><link rel="prefetch" href="/assets/js/20.8f67c846.js"><link rel="prefetch" href="/assets/js/3.25cc2e99.js"><link rel="prefetch" href="/assets/js/4.84193cfc.js"><link rel="prefetch" href="/assets/js/5.46b6901b.js"><link rel="prefetch" href="/assets/js/6.b1568c1b.js"><link rel="prefetch" href="/assets/js/7.01dbaa82.js"><link rel="prefetch" href="/assets/js/8.91e8a3c3.js"><link rel="prefetch" href="/assets/js/9.c235976c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b4c82722.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人杂记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/life/RM2100.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  生活
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习" class="dropdown-title"><span class="title">学习</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习" class="mobile-dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/html_css_js/html_css.html" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/study/literary/extract.html" class="nav-link">
  文学
</a></li><li class="dropdown-item"><!----> <a href="/study/questions/mysql_pass.html" class="nav-link">
  环境问题
</a></li></ul></div></div><div class="nav-item"><a href="http://flysch.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  岩夹
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/Icestab/Notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/life/RM2100.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  生活
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习" class="dropdown-title"><span class="title">学习</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习" class="mobile-dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/html_css_js/html_css.html" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/study/literary/extract.html" class="nav-link">
  文学
</a></li><li class="dropdown-item"><!----> <a href="/study/questions/mysql_pass.html" class="nav-link">
  环境问题
</a></li></ul></div></div><div class="nav-item"><a href="http://flysch.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  岩夹
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/Icestab/Notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>生活</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/life/RM2100.html" aria-current="page" class="active sidebar-link">红米2100路由器刷机</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/life/RM2100.html#_1、开启ssh" class="sidebar-link">1、开启SSH</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/life/RM2100.html#_1-1确认版本" class="sidebar-link">1.1确认版本</a></li><li class="sidebar-sub-header"><a href="/life/RM2100.html#_1-2漏洞利用" class="sidebar-link">1.2漏洞利用</a></li></ul></li><li class="sidebar-sub-header"><a href="/life/RM2100.html#_2、刷入breed" class="sidebar-link">2、刷入Breed</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/life/RM2100.html#_2-1备份" class="sidebar-link">2.1备份</a></li><li class="sidebar-sub-header"><a href="/life/RM2100.html#_2-2刷入breed" class="sidebar-link">2.2刷入breed</a></li></ul></li><li class="sidebar-sub-header"><a href="/life/RM2100.html#_3、刷入固件" class="sidebar-link">3、刷入固件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/life/RM2100.html#_3-1下载" class="sidebar-link">3.1下载</a></li><li class="sidebar-sub-header"><a href="/life/RM2100.html#_3-2刷入固件" class="sidebar-link">3.2刷入固件</a></li></ul></li></ul></li><li><a href="/life/ss/vpn.html" class="sidebar-link">科学上网</a></li><li><a href="/life/oh-my-zsh.html" class="sidebar-link">oh-my-zsh安装与基本配置</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="红米2100路由器刷机"><a href="#红米2100路由器刷机" class="header-anchor">#</a> 红米2100路由器刷机</h1> <p>很久以前买了RM2100，小米官方固件虽然将就用着还行，但是功能太少，前段日子无聊去恩山论坛研究了下怎么刷Padavan，成功后记录一下。</p> <h2 id="_1、开启ssh"><a href="#_1、开启ssh" class="header-anchor">#</a> 1、开启SSH</h2> <h3 id="_1-1确认版本"><a href="#_1-1确认版本" class="header-anchor">#</a> 1.1确认版本</h3> <p>利用官方固件漏洞开启SSH，官方<strong>2.0.7</strong>*版本存在漏洞，所以第一步确认你手里面的机器目前的版本。</p> <p>本我有新系统就更新的习惯，所以我手里的路由器是最新版，没关系我们降级就行了。</p> <p><strong>官方下载链接：</strong>
红米RM2100： <a href="http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_firmware_d6234_2.0.7.bin" target="_blank" rel="noopener noreferrer">http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/rm2100/miwifi_rm2100_firmware_d6234_2.0.7.bin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>小米R2100：<a href="http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/r2100/miwifi_r2100_firmware_4b519_2.0.722.bin" target="_blank" rel="noopener noreferrer">http://cdn.cnbj1.fds.api.mi-img.com/xiaoqiang/rom/r2100/miwifi_r2100_firmware_4b519_2.0.722.bin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>miwifi_rm2100开头的是红米的，miwifi_r2100开头的是小米的。</p> <p>降级方法非常简单，电脑登录管理页面，在升级固件处选择手工选择，然后确认后等待机器重启即可。</p> <h3 id="_1-2漏洞利用"><a href="#_1-2漏洞利用" class="header-anchor">#</a> 1.2漏洞利用</h3> <p>登录管理页面，此时地址栏链接应为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://192.168.31.1/cgi-bin/luci/;stok=&lt;STOK&gt;/web/home#router
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>PS:</strong><code>&lt;STOK&gt;</code>是代表你登录后自动生成的那一长串数据，每个人都不一样，用于替换下一步中的链接中部分。</p> <p>在浏览器地址栏中输入以下链接代码，<strong>注意替换掉</strong><code>&lt;STOK&gt;</code><strong>部分，否则无效</strong>：</p> <p><code>http://192.168.31.1/cgi-bin/luci/;stok=&lt;STOK&gt;/api/misystem/set_config_iotdev?bssid=Xiaomi&amp;user_id=longdike&amp;ssid=-h%3B%20nvram%20set%20ssh_en%3D1%3B%20nvram%20commit%3B%20sed%20-i%20's%2Fchannel%3D.*%2Fchannel%3D%5C%22debug%5C%22%2Fg'%20%2Fetc%2Finit.d%2Fdropbear%3B%20%2Fetc%2Finit.d%2Fdropbear%20start%3B</code></p> <p>返回{&quot;code&quot;:0}即代表成功。</p> <p>建议**一键注入后需等待一些时间，保证路由器后台能正确处理注入信息后再重启，**重启即可开启SSH。</p> <p><strong>接下来更改root密码：</strong></p> <p>在浏览器地址栏中输入以下链接代码，<strong>注意替换掉</strong><code>&lt;STOK&gt;</code><strong>部分，否则无效</strong>：</p> <p><code>http://192.168.31.1/cgi-bin/luci/;stok=&lt;STOK&gt;/api/misystem/set_config_iotdev?bssid=Xiaomi&amp;user_id=longdike&amp;ssid=-h%3B%20echo%20-e%20'admin%5Cnadmin'%20%7C%20passwd%20root%3B</code></p> <p>'admin'表示输入两次密码以修改密码为admin，想要自行设置密码的仅需要改动两个字符admin即可，其他地方不要改，怕出问题或记不住的不用修改。</p> <p>使用SSH软件登录路由器，我用的Xshell，你们有什么用什么。</p> <h2 id="_2、刷入breed"><a href="#_2、刷入breed" class="header-anchor">#</a> 2、刷入Breed</h2> <h3 id="_2-1备份"><a href="#_2-1备份" class="header-anchor">#</a> 2.1备份</h3> <p>如果后面想刷回官方需要备份一下<strong>BootLoader</strong>，建议都备份一下，代码如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dd if=/dev/mtd1 of=/tmp/bootloader.bin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>输入命令后一定要将&quot;/tmp/bootloader.bin&quot;<strong>移动到电脑上</strong>后再操作下一步</p> <p>对了我传文件用的winscp，你们有什么用什么。</p> <h3 id="_2-2刷入breed"><a href="#_2-2刷入breed" class="header-anchor">#</a> 2.2刷入breed</h3> <p><strong>下载breed：</strong></p> <p>文件名： breed-mt7621-xiaomi-r3g.bin</p> <p>H大链接(<strong>建议</strong>) ：<a href="https://breed.hackpascal.net/breed-mt7621-xiaomi-r3g.bin" target="_blank" rel="noopener noreferrer">https://breed.hackpascal.net/breed-mt7621-xiaomi-r3g.bin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>刷入不死Breed</strong>：</p> <p>复制breed-mt7621-xiaomi-r3g.bin 到/tmp</p> <p>输入命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mtd -r write /tmp/breed-mt7621-xiaomi-r3g.bin Bootloader
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>等待路由器重启（当电脑获取到ip或者路由只有一个蓝灯亮时，breed引导官方固件成功）。</p> <p>为防止变砖，强烈<strong>建议等待5分钟后拔电，用牙签按住reset键再插电，等蓝灯闪烁，松开reset键，浏览器访问192.168.1.1</strong>即可进入breedweb界面。</p> <p>首次进入breed记得先备份下编程器固件和eeprom。</p> <p>更改环境变量，编缉,新增字段&quot;xiaomi.r3g.bootfw&quot;,值设置为 2,然后保存。（否则刷入非原厂固件可能会出现刷入固件后重启指示灯不断蓝黑交替（无限重启）的现象）</p> <p>至此，路由器成功刷入breed。</p> <h2 id="_3、刷入固件"><a href="#_3、刷入固件" class="header-anchor">#</a> 3、刷入固件</h2> <h3 id="_3-1下载"><a href="#_3-1下载" class="header-anchor">#</a> 3.1下载</h3> <p>Padavan(HIBOY)固件</p> <p>红米ac2100：<a href="http://opt.cn2qq.com/padavan/RM2100_3.4.3.9-099.trx" target="_blank" rel="noopener noreferrer">http://opt.cn2qq.com/padavan/RM2100_3.4.3.9-099.trx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>小米ac2100：<a href="http://opt.cn2qq.com/padavan/R2100_3.4.3.9-099.trx" target="_blank" rel="noopener noreferrer">http://opt.cn2qq.com/padavan/R2100_3.4.3.9-099.trx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>这个链接下载的一直都是最新版本！</p> <h3 id="_3-2刷入固件"><a href="#_3-2刷入固件" class="header-anchor">#</a> 3.2刷入固件</h3> <p>点击“固件更新”-在“固件”位置上传trx文件</p> <p>中复选框&quot;自动重启&quot;-点击上传</p> <p>确认更新信息-点击&quot;更新&quot;-等待路由器重启</p> <p>等待路由器LED灯恢复正常后-打开浏览器-进入<strong>http://my.router</strong></p> <p>用户名&quot;admin&quot;-密码&quot;admin&quot;</p> <p>显示下图-正常刷入。</p> <p><img src="/assets/img/1.59315e3c.jpg" alt="1"></p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>对了恩山还说了有些路由器有坏块刷不了，不过我没遇到过，如果你在刷入时遇到问题基本就是这个原因了。</p> <p>刷机请用网线。</p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">3/3/2022, 3:46:14 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/life/ss/vpn.html">
        科学上网
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.549933da.js" defer></script><script src="/assets/js/2.8ec7856a.js" defer></script><script src="/assets/js/10.743f19ee.js" defer></script>
  </body>
</html>
